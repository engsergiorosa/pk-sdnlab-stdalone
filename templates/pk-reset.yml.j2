---
# purpose: Create dummies interfaces abd bridges.
# purpose: Create devices in packet.net site.
# CAUTION: WIll reboot the KVM server
# CAUTION: It would change your selinux, forwarding and iptables seetings
# CAUTION: Will disable NetworkManager and firewall
# Author: Mauricio Rojas / pinrojas.com

- hosts: localhost
  gather_facts: no
  remote_user: root
  vars:
    packet_token: {{ packet_token }}
    project_id: {{ project_id }}
    bmetals:
      - { device_name: core ,
          bmetal_plan: baremetal_2 ,
          osystem: centos_7 ,
          facility: sjc1 ,
          public_if: bond0 ,
          br_connect: [
            { bridge: core, gateway: 192.168.0.1, mask: 255.255.255.0, dhcp_min: 110, dhcp_max: 140 },
            { bridge: wan, gateway: 10.250.250.1, mask: 255.255.255.0, dhcp_min: 110, dhcp_max: 140 },
            { bridge: inet, gateway: 80.80.80.1, mask: 255.255.255.0, dhcp_min: 110, dhcp_max: 140 },
            { bridge: branch1 },
            { bridge: branch2 }
          ]
        }
      - { device_name: jumpbox ,
          bmetal_plan: baremetal_0 ,
          osystem: centos_7 ,
          facility: sjc1 ,
          public_if: bond0 ,
          br_connect: [
            { bridge: core }
          ]
        }
 
  roles:
    - pk-reset
